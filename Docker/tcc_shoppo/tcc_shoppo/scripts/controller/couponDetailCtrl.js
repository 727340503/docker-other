function couponDetailCtrl(a,b,c,d,e,f,g,h){b.form=f,b.form.topBar.showTopBar=!0,b.form.topBar.showMenuBtn=!1,f.topBar.showLogo=!1,b.form.topBar.topBarTitle=d.instant("couponDetail"),b.form.topBar.showBackBtn=!0,b.form.topBar.lastPage="/main/promotion",b.nolist=!1,b.pageLimit=20,b.form.showGotoTop=!1,b.showShoppingCart=!1,b.showSearch=!1,b.showFilter=!1,b.cashQtyText=!1,b.showBestProduct=!0,b.form.bottomMenu=!1,b.qrCodeMessageSuccess=!1,b.form.topBar.showShareBtn=!1;var i=!0;b.$root.gotoLastPage=function(){c.path(b.form.topBar.lastPage)},b.getCouponDetail=function(){var a=copyData(b.form.userInfo);a.couponId=b.form.couponDetail.id,a.merchantId=b.form.couponDetail.merchantId;var c=apiDomain+getCouponDetail;$.ajax({type:AJAX_TYPE,data:a,url:c,context:document.body,success:function(a){apiResultsProcessingFun(a,function(){b.couponDetail=a.result,b.currDate=getTimeStamp(b.couponDetail.currDate),b.collStartTime=getTimeStamp(b.couponDetail.collectStartTime),b.collEndTime=getTimeStamp(b.couponDetail.collectEndTime),b.collStartTime<=b.currDate&&b.currDate<=b.collEndTime?(b.canCollect=!0,fixedPosition("reservation-form",55)):b.canCollect=!1,b.couponDetail.collectEndTime=formatDate(b.couponDetail.collectEndTime,b.form.dateFormat),b.$apply()})}})},b.collectCoupon=function(){if(i){i=!1;var a=copyData(b.form.userInfo);a.langCode=b.form.userInfo.langCode,a.couponId=b.form.couponDetail.id,a.merchantId=b.form.couponDetail.merchantId;var c=apiDomain+saveUserCoupon;$.ajax({type:AJAX_TYPE,data:a,url:c,context:document.body,success:function(a){apiResultsProcessingFun(a,function(){b.collectCouponSuccess(),b.$apply()})}})}},b.collectCouponSuccess=function(){b.saveCoupon=!0,b.closeThisDialog=function(){b.saveCoupon=!1,i=!0,g(function(){c.path("main/promotion")})},h(b,{templateUrl:"pages/common/JsBarcode128Dlg.html?rnd="+rndver,preCloseCallback:b.closeThisDialog})},b.init=function(){b.getCouponDetail()},b.init()}var CouponDetailCtrl=["$filter","$scope","$location","$translate","$state","form","$timeout","shoppoDialog",couponDetailCtrl];angular.module("shoppoweb").controller("CouponDetailCtrl",CouponDetailCtrl);