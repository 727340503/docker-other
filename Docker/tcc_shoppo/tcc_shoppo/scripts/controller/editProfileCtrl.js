function editProfileCtrl(a,b,c,d,e,f,g,h){b.form=f,b.form.topBar.showTopBar=!0,b.form.topBar.topBarTitle=d.instant("editProfile"),b.form.topBar.showBackBtn=!0,b.form.bottomMenu=!1,b.form.topBar.lastPage="main/accountManagement",b.$root.gotoLastPage=function(){g(function(){c.path(b.form.topBar.lastPage)},200)},b.form.userInfo.contactEmail||(b.form.userInfo.contactEmail=b.form.userInfo.email),b.form.userInfo.birthday&&(b.form.userInfo.birthday=b.form.userInfo.birthday.substring(0,10)),b.genderList=[{name:"Male"},{name:"Female"}],jQuery.validator.addMethod("checkSpace",function(a,b,c){return 0!=a.replace(/\s/g,"").length},$.validator.format("Cannot be an empty string")),jQuery.validator.addMethod("checkName",function(a,b,c){return 0==a.replace(/^(?![0-9]+$)(?![a-z]+$)[0-9a-z]{8,12}$/,"").length},$.validator.format("Enter 8-12 lowercase letters (a-z)/numbers (0-9)")),$("#setProfile").validate({errorPlacement:function(a,b){b.after(a)},rules:{userName:{required:!1,checkName:!0},email:{required:!1}},messages:{},submitHandler:function(a){b.updateUserPofile()}}),b.$watch(function(){return $(".contactEmail").val()},function(a,b){$(".contactEmail").val(trim(a))}),b.submit=function(){$("#setProfile").submit()},b.$watch("form.userInfo.phone",function(a,c){new RegExp("^[0-9]*$").test(a)?b.form.userInfo.phone=a:b.form.userInfo.phone=c,""!=a&&a||(b.form.userInfo.phone="")}),b.$on("onRepeatLast",function(a,c,d){$("#phoneAreaCode").mobiscroll().treelist({theme:"ios",display:"bottom",lang:"en_US",labels:["business"],onSelect:function(a,c){a=a.substr(a.indexOf("+"),a.length),$("#phoneAreaCode_dummy").val(a),a=a.replace("+","00"),b.phoneAreaCode=a}}),$("#gender").mobiscroll().treelist({theme:"ios",display:"bottom",lang:"en_US",labels:["business"],onSelect:function(a,c){b.gender=a}});g(function(){b.form.userInfo.phoneAreaCode?$("#phoneAreaCode_dummy").val(phoneCodeFormat(b.form.userInfo.phoneAreaCode)):(b.phoneAreaCode=b.form.phoneAreaCode,$("#phoneAreaCode_dummy").val(phoneCodeFormat(b.phoneAreaCode))),b.gender=b.form.userInfo.gender,$("#gender_dummy").val(b.form.userInfo.gender),$("#birthday_dummy").val(b.form.userInfo.birthday)},200)}),g(function(){$("#birthday").mobiscroll().date({theme:"ios",mode:"scroller",display:"bottom",dateFormat:"yyyy-mm-dd",lang:"en_US",maxDate:new Date,defaultValue:new Date("1990/01/01 00:00:00")}),$(".dwwc").css("display","-webkit-flex")}),b.updateUserPofile=function(){var a=copyData(b.form.userInfo);a.gender=b.gender;var c=apiDomain+updateUserPofile;$.ajax({type:AJAX_TYPE,url:c,context:document.body,data:a,success:function(a){apiResultsProcessingFun(a,function(){b.form.getPofile(),b.gotoAccountManagement(),b.$apply()})}})},b.gotoAccountManagement=function(){c.path("main/accountManagement")},b.getUserPofile=function(){var a=copyData(b.form.userInfo),c=apiDomain+getUserPofile;$.ajax({type:AJAX_TYPE,url:c,context:document.body,data:a,success:function(a){apiResultsProcessingFun(a,function(){b.form.userInfo=$.extend(b.form.userInfo,a.result),b.$apply()})}})},b.facebookLogin=function(){getfaceBookUserInfo=function(a){g(function(){var c=JSON.parse(a.result);b.checkFbEvent(c)})},1==b.form.isInApp&&(window.location.href="tcc://shoppo?func=facebookLogin&callback=getfaceBookUserInfo")},b.checkFbEvent=function(a){var c=copyData(b.form.userInfo);c.snsId=a.id,c.snsType=1,c.snsAccessToken=a.token;var d=apiDomain+checkIsExistFbAccount;$.ajax({type:AJAX_TYPE,url:d,context:document.body,data:c,success:function(c){apiResultsProcessingFun(c,function(){1==c.result?angular.element("body").scope().$root.warningDlg({msg:"An account already exists under this Facebook account."}):(b.form.userInfo.snsId=a.id,b.form.userInfo.snsAccessToken=a.token,b.form.userInfo.snsType=1),b.$apply()})}})},b.iconClick=function(a){$("#"+a+"_dummy").click()},b.birthdayClick=function(){$("#birthday").click()},b.init=function(){},b.init()}var EditProfileCtrl=["$filter","$scope","$location","$translate","$state","form","$timeout","shoppoDialog",editProfileCtrl];angular.module("shoppoweb").controller("EditProfileCtrl",EditProfileCtrl);