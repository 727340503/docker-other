function resetMobileCtrl(a,b,c,d,e,f){a.form=f,a.form.topBar.topBarTitle=c.instant("Set mobile"),a.form.topBar.showTopBar=!0,a.form.topBar.lastPage="/main/accountManagement",a.form.fromLanding?(a.form.topBar.lastPage="",a.form.topBar.topBarTitle=c.instant("Mobile registration")):(a.form.topBar.showBackBtn=!0,a.form.topBar.topBarTitle=c.instant("Reset mobile number"),a.form.topBar.lastPage="/main/accountManagement"),a.form.bottomMenu=!1,a.facebookIsReady=!0,a.page=1,a.overResendTimes=!0,a.form.setMobile&&(a.phone=a.form.phone,a.phoneAreaCode=a.form.userPhoneAreaCode,a.form.setMobile=!1),a.$on("onRepeatLast",function(b,c,d){$("#phoneAreaCode").mobiscroll().treelist({theme:"ios",display:"bottom",lang:"en_US",labels:["business"],onSelect:function(b,c){b=b.substr(b.indexOf("+"),b.length),$("#phoneAreaCode_dummy").val(b),b=b.replace("+","00"),a.phoneAreaCode=b}});e(function(){a.phoneAreaCode||(a.phoneAreaCode=a.form.phoneAreaCode),$("#phoneAreaCode_dummy").val(phoneCodeFormat(a.phoneAreaCode))},200)}),a.$root.gotoLastPage=function(){e(function(){a.form.fromLanding=!1,b.path(a.form.topBar.lastPage)},200)},a.$root.closePopup=function(){a.overResendTimes=!0,a.form.topBar.topBarTitle=c.instant("Login"),a.page=1,a.form.topBar.showBackBtn=!0,a.form.topBar.showCloseBtn=!1,a.form.topBar.showRegisterBtn=!0},a.preRegister=function(){a.form.topBar.topBarTitle=c.instant("Fill passcode"),a.page=2,e(function(){$(".verifyCode").focus()}),a.form.topBar.showBackBtn=!1,a.form.topBar.showCloseBtn=!0,a.form.topBar.showRegisterBtn=!1},a.sendSmsEvent=function(b){$(".phoneInput").blur(),e(function(){var c=copyData(a.form.userInfo);c.phoneAreaCode=a.phoneAreaCode.replace("+","00"),c.phone=a.phone,c.verifyType=b;var d=apiDomain+sendSms;$.ajax({type:AJAX_TYPE,url:d,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.smsVerifyId=b.result.smsVerifyId,a.form.userInfo.phoneAreaCode=a.phoneAreaCode,a.form.userInfo.phone=a.phone,10484==b.errorCode?angular.element("body").scope().$root.warningDlg({msg:b.errorMessage}):(a.preRegister(),a.timeEvent()),a.$apply()})}})},200)},a.time=0;var g;a.timeEvent=function(){a.time=60,g&&clearInterval(g),g=setInterval(function(){a.time--,a.time<=0&&(clearInterval(g),a.time=0),a.$apply()},1e3)},a.resendSmsEvent=function(){if(0==a.time){var b=copyData(a.form.userInfo);b.phoneAreaCode=a.phoneAreaCode.replace("+","00"),b.phone=a.phone,b.verifyType=3;var c=apiDomain+resendSms;$.ajax({type:AJAX_TYPE,url:c,context:document.body,data:b,success:function(b){apiResultsProcessingFun(b,function(){10484==b.errorCode?(a.overResendTimes=!1,angular.element("body").scope().$root.warningDlg({msg:b.errorMessage}),a.$apply()):(a.overResendTimes=!0,a.timeEvent()),a.$apply()})}})}},a.changePhoneEvent=function(c){if(a.verifyCode){var d=copyData(a.form.userInfo);d.phoneAreaCode=a.phoneAreaCode,d.phone=a.phone,d.verifyCode=a.verifyCode,d.smsVerifyId=a.smsVerifyId;var e=apiDomain+changePhone;$.ajax({type:AJAX_TYPE,url:e,context:document.body,data:d,success:function(c){apiResultsProcessingFun(c,function(){a.updateUserMarketingInfoEvent(),localStorage.removeItem("isCheckMobile"),b.path("main/landing"),a.$apply()})}})}},$("#login").validate({errorPlacement:function(a,b){b.after(a)},rules:{},submitHandler:function(b){a.sendSmsEvent(3)}}),a.submitEvent=function(){$("#login").submit()},a.form.fromLanding?a.agreeTC=!1:a.agreeTC=!0,a.isMarketingInfo=0,a.agreeTCFn=function(){a.agreeTC?a.agreeTC=!1:a.agreeTC=!0},a.gotoPrivacy=function(){a.form.setMobile=!0,a.form.phone=a.phone,a.form.userPhoneAreaCode=a.phoneAreaCode,"en_US"==c.use()&&b.path("/main/privacy_en_US")},a.gotoTAndC=function(){a.form.setMobile=!0,a.form.phone=a.phone,a.form.userPhoneAreaCode=a.phoneAreaCode,"en_US"==c.use()&&b.path("/main/tAndC_en_US")},a.isMarketingInfoFn=function(){1==a.isMarketingInfo?a.isMarketingInfo=0:a.isMarketingInfo=1},a.updateUserMarketingInfoEvent=function(){var b=copyData(a.form.userInfo);b.isMarketingInfo=a.isMarketingInfo;var c=apiDomain+updateUserMarketingInfo;$.ajax({type:AJAX_TYPE,url:c,context:document.body,data:b,success:function(b){apiResultsProcessingFun(b,function(){a.$apply()})}})}}var ResetMobileCtrl=["$scope","$location","$translate","$state","$timeout","form",resetMobileCtrl];angular.module("shoppoweb").controller("ResetMobileCtrl",ResetMobileCtrl),keepSession=!0;