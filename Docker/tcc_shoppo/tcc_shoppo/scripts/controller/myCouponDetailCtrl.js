function myCouponDetailCtrl(a,b,c,d,e,f,g,h){b.form=f,b.form.topBar.showTopBar=!0,b.form.topBar.showMenuBtn=!1,f.topBar.showLogo=!1,b.form.topBar.topBarTitle=d.instant("couponDetail"),b.form.topBar.showBackBtn=!0,b.form.topBar.showShareBtn=!0,b.form.topBar.lastPage="/main/promotion",b.nolist=!1,b.pageLimit=20,b.form.showGotoTop=!1,b.showShoppingCart=!1,b.showSearch=!1,b.showFilter=!1,b.cashQtyText=!1,b.showBestProduct=!0,b.form.bottomMenu=!1,b.qrCodeMessageSuccess=!1,b.showCouponCode=!1,b.showCollectCode=!1;var i=!0;b.$root.gotoLastPage=function(){c.path(b.form.topBar.lastPage)},b.$root.gotoShare=function(){var a=b.form.myCouponDetail.name,c=b.form.myCouponDetail.img,d=b.form.myCouponDetail.name;b.form.shareEvent(a,c,d),sendGAEvent(b.form.myCouponDetail.name,"couponDetail - "+b.form.myCouponDetail.name,"Share",1)},b.redeemCouponEvent=function(){b.descr=b.form.myCouponDetail.descr,b.qrCodeCoupon=b.form.myCouponDetail.qrCode,b.barCodeCoupon=b.form.myCouponDetail.qrCode,b.qrCode=b.form.myCouponDetail.collectCode,b.barCode=b.form.myCouponDetail.collectCode,b.redeemCoupon=!0,b.showCouponCode=!0,b.showCollectCode=!1,i=!1,b.closeThisDialog=function(){b.redeemCoupon=!1,b.showCouponCode=!1,b.showCollectCode=!1,i=!0},h(b,{templateUrl:"pages/common/JsBarcode128Dlg.html?rnd="+rndver,preCloseCallback:b.closeThisDialog})},b.showCollectCodeEvent=function(){b.showCouponCode=!1,b.showCollectCode=!0},b.gotoRedeemCoupon=function(){b.form.fromCoupon=!0,b.form.myCouponDetail.collectCode?c.path("main/redeemCoupon"):b.getUserStampCard()},b.getUserStampCard=function(){var a=copyData(b.form.userInfo);a.stampCardId=b.form.myCouponDetail.stampCardId,a.campaignId=b.form.myCouponDetail.campaignId;var d=apiDomain+getUserStampCard;$.ajax({type:AJAX_TYPE,data:a,url:d,context:document.body,success:function(a){apiResultsProcessingFun(a,function(){b.form.myCouponDetail.collectCode=a.result.collectCode,c.path("main/redeemCoupon"),b.$apply()})}})},b.init=function(){b.currDate=getTimeStamp(b.form.myCouponDetail.currDate),b.redeemStartTime=getTimeStamp(b.form.myCouponDetail.redeemStartTime),b.redeemEndTime=getTimeStamp(b.form.myCouponDetail.redeemEndTime),b.redeemStartTime<=b.currDate&&b.currDate<=b.redeemEndTime?(b.canRedeem=!0,fixedPosition("reservation-form",55)):b.canRedeem=!1,b.form.myCouponDetail.redeemEndTimeText=formatDate(b.form.myCouponDetail.redeemEndTime,b.form.dateFormat)},b.init()}var MyCouponDetailCtrl=["$filter","$scope","$location","$translate","$state","form","$timeout","shoppoDialog",myCouponDetailCtrl];angular.module("shoppoweb").controller("MyCouponDetailCtrl",MyCouponDetailCtrl);