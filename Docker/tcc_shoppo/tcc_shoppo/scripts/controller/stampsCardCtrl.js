function stampsCardCtrl(a,b,c,d,e,f,g){b.form=g,b.form.topBar.showTopBar=!0,b.form.topBar.showMenuBtn=!1,b.form.menuMerchantList=!0,b.form.topBar.topBarTitle=d.instant("Stamps"),g.topBar.showLogo=!1,b.form.bottomMenu=!0,b.form.topBar.lastPage="",b.form.fromHomePage=!1,b.unexpiredCampaignList=[],b.expiredCampaignList=[],b.form.backFromExpired?(b.showUnexpiredCampaign=!1,b.showExpiredCampaign=!0,b.form.backFromExpired=!1):(b.showUnexpiredCampaign=!0,b.showExpiredCampaign=!1),b.chooseUnexpiredCampaign=function(){b.showUnexpiredCampaign=!0,b.showExpiredCampaign=!1},b.chooseExpiredCampaign=function(){b.showUnexpiredCampaign=!1,b.showExpiredCampaign=!0},b.gotoStampsDetail=function(a){b.form.campainTerms=a.terms,b.form.campaignId=a.campaignId,b.form.stampCardId=a.stampCardId,b.form.stampsCardCoverImg=a.coverImg,b.form.stampsCardBgImg=a.bgImg,b.form.stampPageTab=!0,c.path("main/stampsDetail")},b.gotoStampsDetailExpired=function(a){b.form.campainTerms=a.terms,b.form.campaignId=a.campaignId,b.form.stampCardId=a.stampCardId,b.form.stampsCardCoverImg=a.coverImg,b.form.stampsCardBgImg=a.bgImg,b.form.stampPageTab=!0,c.path("main/stampsDetailExpired")},b.openLink=function(a,c){a&&(1==c?1==b.form.isInApp?window.location="tcc://shoppo?func=inappUrl&url="+a:(b.form.webUrl=a,$("#iframed").empty(),$("#iframed").append("<i class='icon-close' onclick='back()'></i><iframe class='game-iframe' src='"+a+"'scrolling='no' frameborder='0' sandbox='allow-forms allow-scripts'></iframe>"),$("#iframed").css("display","block"),$("#home").css("display","none")):1==b.form.isInApp&&(window.location="tcc://shoppo?func=nativeUrl&url="+a))},b.getListCampain=function(){var a=copyData(b.form.userInfo),c=apiDomain+listCampaign;$.ajax({type:AJAX_TYPE,data:a,url:c,context:document.body,success:function(a){apiResultsProcessingFun(a,function(){for(b.listCampaign=a.result,i=0;i<b.listCampaign.length;i++)b.listCampaign[i].startTimeStamp=getTimeStamp(b.listCampaign[i].startTime),b.listCampaign[i].endTimeStamp=getTimeStamp(b.listCampaign[i].endTime),b.listCampaign[i].currDate=getTimeStamp(b.listCampaign[i].currDate),b.listCampaign[i].startTime=formatDate(b.listCampaign[i].startTime,b.form.dateFormat),b.listCampaign[i].endTime=formatDate(b.listCampaign[i].endTime,b.form.dateFormat),3==b.listCampaign[i].status?b.expiredCampaignList.push(b.listCampaign[i]):2!=b.listCampaign[i].status&&1!=b.listCampaign[i].status||b.unexpiredCampaignList.push(b.listCampaign[i]);b.$apply()})}})},b.gotoRegistration=function(){b.form.isFromStampCard=!0,c.path("main/registration")},b.init=function(){b.getListCampain(),f(function(){$(".card-list").height($(window).height()-60-65-41-30)},200)},b.init()}var StampsCardCtrl=["$filter","$scope","$location","$translate","$state","$timeout","form",stampsCardCtrl];angular.module("shoppoweb").controller("StampsCardCtrl",StampsCardCtrl);