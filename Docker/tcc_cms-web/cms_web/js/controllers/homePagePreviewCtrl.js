function homePagePreviewCtrl(a,b,c,d,e,f,g){a.form=e,a.cancel=function(){f.path("/main/homePage")},a.getMerchantDetail=function(){var b=apiDomain+getMerchantDetailApi,c=copyData(a.form.userInfo);c.merchantId=a.form.merchantId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.merchantDetail=b.result;for(var c=0;c<a.merchantDetail.merchantLangMapList.length;c++)a.merchantDetail.merchantLangMapList[c].isDefault&&(a.pageLanguage=a.merchantDetail.merchantLangMapList[c].langCode);a.$apply()})}})},a.getMerchantDetail(),a.getMerchantHomePage=function(){var b=apiDomain+getMerchantHomePageApi,c=copyData(a.form.userInfo);c.merchantId=a.form.merchantId,c.status=0,c.langCode=a.pageLanguage,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){if(a.homepage=angular.fromJson(b.result.homePageFrame),a.records=b.result.homePageData,a.homepage){a.data={};for(var c=0;c<a.records.length;c++)a.data[a.records[c].refId+"_"+a.records[c].type]=a.records[c];a.flexsliderLanding(),a.flexsliderCoupon()}else a.homepage=[[],[],[],[]],a.records=[];a.$apply()})}})},a.getMerchantHomePage(),a.saveEvent=function(){for(var b=apiDomain+updateMerchantHomePageApi,c=copyData(a.form.userInfo),d=[],e=0;e<a.records.length;e++)d.push({id:a.records[e].id,merchantId:a.records[e].merchantId,refId:a.records[e].refId,type:a.records[e].type,inappOpen:a.records[e].inappOpen});c.merchantId=a.form.merchantId,c.homePageFrame=angular.toJson(a.homepage),c.homePageData=angular.toJson(d),$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.getMerchantHomePage(),a.$apply()})}})},a.publishEvent=function(){var b=apiDomain+publishMerchantHomePageApi,c=copyData(a.form.userInfo);c.merchantId=a.form.merchantId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.getMerchantHomePage(),a.$apply()})}})},a.statusClass={1:"warning",2:"success",3:"info",4:"danger"},a.sortableOptions0={connectWith:".connectList0"},a.sortableOptions1={connectWith:".connectList1"},a.sortableOptions2={connectWith:".connectList2"},a.sortableOptions3={connectWith:".connectList3"},a.flexsliderLanding=function(){$(".flexsliderLand").remove();for(var b='<div class="flexsliderLand flexslider"><ul class="slides">',c=0;c<a.homepage[0].length;c++)b+='<li><img src="'+a.data[a.homepage[0][c].refId+"_"+a.homepage[0][c].type].img+'"></li>';b+="</ul></div>",$(".landing").append(b),$(".flexsliderLand").flexslider({animation:"slide",directionNav:!1,slideshow:!1,slideshowSpeed:1e3,prevText:"",nextText:"",controlNav:!0})},a.flexsliderCoupon=function(){$(".flexsliderCoupon").remove();for(var b='<div class="flexsliderCoupon flexslider"><ul class="slides">',c=0;c<a.homepage[2].length;c++)b+='<li ><img src="'+a.data[a.homepage[2][c].refId+"_"+a.homepage[2][c].type].img+'"></li>';b+="</ul></div>",$(".coupon").append(b),$(".flexsliderCoupon").flexslider({animation:"slide",directionNav:!1,slideshow:!1,slideshowSpeed:1e3,prevText:"",nextText:"",controlNav:!0})}}var HomePagePreviewCtrl=["$scope","$translate","$state","$timeout","form","$location","$modal",homePagePreviewCtrl];angular.module("keeperp").controller("HomePagePreviewCtrl",HomePagePreviewCtrl);