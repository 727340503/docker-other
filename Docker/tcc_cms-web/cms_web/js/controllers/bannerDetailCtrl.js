function bannerDetailCtrl(a,b,c,d,e,f,g){if(a.form=e,a.cancel=function(){f.path("/main/bannerList")},a.form.bannerId)var h={};else var h={logo:{required:!0}};$("#baseInfo").validate({errorPlacement:function(a,b){b.parent().after(a)},rules:h,messages:{},submitHandler:function(b){a.form.bannerId?a.updateBanner():a.addBanner()}}),a.addBanner=function(){if(a.bannerDetail.webUrl)if(a.bannerDetail.webUrl.indexOf("http://")<0&&a.bannerDetail.webUrl.indexOf("https://")<0)var b="http://"+a.bannerDetail.webUrl;else b=a.bannerDetail.webUrl;var c=apiDomain+createBannerApi,e=copyData(a.form.userInfo);e.merchantId=a.bannerDetail.merchantId,e.webUrl=b,e.status=a.bannerDetail.status,e.inappOpen=a.bannerDetail.inappOpen,e.startTime=a.bannerDetail.startTime,e.endTime=a.bannerDetail.endTime,a.bannerDetail.langData.img=a.image,e.langData=[],e.langData.push(a.bannerDetail.langData),e.langData=angular.toJson(e.langData),$.ajax({type:a.form.postType,url:c,context:document.body,data:e,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),d(function(){f.path("/main/bannerList")})})}})},a.getBannerDetail=function(){var b=apiDomain+getBannerDetailApi,c=copyData(a.form.userInfo);c.bannerId=a.form.bannerId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.bannerDetail=b.result,a.bannerDetail.merchantId+="",a.bannerDetail.inappOpen+="",a.bannerDetail.status+="",a.bannerDetail.langData=a.bannerDetail.bannerLangMaps[0],a.image=a.bannerDetail.langData.img,a.bannerDetail.langData.img=a.bannerDetail.langData.fullImg,a.pageLanguage=a.bannerDetail.langData.langCode,1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.bannerDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)),a.$apply()})}})},a.updateBanner=function(){if(a.bannerDetail.webUrl)if(a.bannerDetail.webUrl.indexOf("http://")<0&&a.bannerDetail.webUrl.indexOf("https://")<0)var b="http://"+a.bannerDetail.webUrl;else b=a.bannerDetail.webUrl;var c=apiDomain+updateBannerApi,d=copyData(a.form.userInfo);d.bannerId=a.form.bannerId,d.webUrl=b,d.status=a.bannerDetail.status,d.inappOpen=a.bannerDetail.inappOpen,d.startTime=a.bannerDetail.startTime,d.endTime=a.bannerDetail.endTime,d.langData=[{id:a.bannerDetail.langData.id,name:a.bannerDetail.langData.name,img:a.image,langCode:a.bannerDetail.langData.langCode}],d.langData=angular.toJson(d.langData),$.ajax({type:a.form.postType,url:c,context:document.body,data:d,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),a.getBannerDetail()})}})},a.merchantListEvent=function(){var b=apiDomain+getMerchantListApi,c=copyData(a.form.userInfo);c.startRow=0,c.maxRows=1e6,c.sortType="ASC",c.sortField="id",$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.merchantList=b.resultList,a.$apply()})}})},a.getMerchantDetail=function(b){var c=apiDomain+getMerchantDetailApi,d=copyData(a.form.userInfo);d.merchantId=b,$.ajax({type:a.form.postType,url:c,context:document.body,data:d,success:function(b){apiResultsProcessingFun(b,function(){for(var c=0;c<a.form.languageList.length;c++)a.form.languageList[c].select=!1;a.merchantDetail=b.result;for(var c=0;c<a.merchantDetail.merchantLangMapList.length;c++)a.merchantDetail.merchantLangMapList[c].isDefault&&(a.bannerDetail.langData.langCode=a.merchantDetail.merchantLangMapList[c].langCode);a.$apply()})}})},a.selectPageLang=function(){d(function(){for(var b=0;b<a.bannerDetail.bannerLangMaps.length;b++)a.bannerDetail.bannerLangMaps[b].langCode==a.pageLanguage&&(a.bannerDetail.langData=a.bannerDetail.bannerLangMaps[b],a.image=a.bannerDetail.langData.img,a.bannerDetail.langData.img=a.bannerDetail.langData.fullImg)})},a.uploadFinish=function(b,c){a.bannerDetail.langData.img=c.fullName,a.image=c.fileName,a.$apply()},a.form.bannerId?a.getBannerDetail():(a.bannerDetail={langData:{},inappOpen:"1"},1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.bannerDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)))}var BannerDetailCtrl=["$scope","$translate","$state","$timeout","form","$location","$modal",bannerDetailCtrl];angular.module("keeperp").controller("BannerDetailCtrl",BannerDetailCtrl);