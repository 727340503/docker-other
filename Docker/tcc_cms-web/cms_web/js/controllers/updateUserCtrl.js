function updateUserCtrl(a,b,c,d,e,f,g,h){a.form=d,a.roleList=[],a.mallInput=!1,a.getSystemRoleList=function(){var b=apiDomain+getSystemRoleAllListApi,c=copyData(a.form.userInfo);c.startRecord=0,c.maxRecords=1e6,c.sortType="ASC",c.sortField="createdTime",$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.roleList=b.result,a.$apply()})}})},a.getSystemUserDetail=function(){var b=apiDomain+getSystemUserDetailApi,c=copyData(a.form.userInfo);c.systemUserId=a.form.userId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.userDetail=b.result,a.userDetail.status+="",a.userDetail.systemRoleId+="",a.userDetail.merchantId+="",a.roleType=a.userDetail.roleType,"1"==a.userDetail.status?a.statusText=g("translate")("Active"):a.statusText=g("translate")("Inactive"),1==a.userDetail.roleType?a.mallInput=!1:a.mallInput=!0,a.$apply()})}})},a.merchantListEvent=function(){var b=apiDomain+getMerchantListApi,c=copyData(a.form.userInfo);c.startRow=0,c.maxRows=1e6,c.sortType="ASC",c.sortField="id",$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.merchantList=b.resultList,a.$apply()})}})},a.setRoleName=function(){for(var b=0;b<a.roleList.length;b++)a.roleList[b].id==a.userDetail.systemRoleId&&(a.roleType=a.roleList[b].roleType)},a.setMallName=function(b){a.merchantName=b.name,a.merchantId=b.id},a.setStatus=function(b){1==b?(a.statusText=g("translate")("Active"),a.userDetail.status=1):(a.statusText=g("translate")("Inactive"),a.userDetail.status=0)},a.save=function(){var b=apiDomain+updateSystemUserApi,c=copyData(a.form.userInfo);c.updUserId=a.userDetail.id,c.roleId=a.systemRoleId,c.userName=a.userDetail.userName,c.password=a.password,c.mobile=a.userDetail.mobile,c.email=a.userDetail.email,c.status=a.userDetail.status,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),a.$apply()})}})},jQuery.validator.addMethod("checkPassword",function(a,b,c){return 0==a.replace(/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,15}$/,"").length},$.validator.format("Enter a right format password.")),$("#baseInfo").validate({errorPlacement:function(a,b){b.parent().after(a)},rules:{updatepassword:{required:!1,checkPassword:!0}},messages:{},submitHandler:function(b){a.save()}}),a.cancel=function(){e.path("/main/acountList")},a.init=function(){a.getSystemUserDetail(),a.getSystemRoleList(),a.merchantListEvent()},a.init()}var UpdateUserCtrl=["$scope","$translate","$http","form","$location","uiGridConstants","$filter","i18nService",updateUserCtrl];angular.module("keeperp").controller("UpdateUserCtrl",UpdateUserCtrl);