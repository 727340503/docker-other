function gameDetailCtrl(a,b,c,d,e,f,g){a.form=e,a.cancel=function(){f.path("/main/gameList")},$("#baseInfo").validate({errorPlacement:function(a,b){b.parent().after(a)},rules:{},messages:{},submitHandler:function(b){a.form.gameId?a.updateGame():a.addGame()}}),a.addGame=function(){var b=apiDomain+createGameApi,c=copyData(a.form.userInfo);c.merchantId=a.gameDetail.merchantId,c.webUrl=a.gameDetail.webUrl,c.status=a.gameDetail.status,c.inappOpen=a.gameDetail.inappOpen,c.startTime=a.gameDetail.startTime,c.endTime=a.gameDetail.endTime,a.gameDetail.langData.img=a.image,c.langData=[],c.langData.push(a.gameDetail.langData),c.langData=angular.toJson(c.langData),$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),d(function(){f.path("/main/gameList")})})}})},a.getGameDetail=function(){var b=apiDomain+getGameDetailApi,c=copyData(a.form.userInfo);c.gameId=a.form.gameId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.gameDetail=b.result,a.gameDetail.merchantId+="",a.gameDetail.inappOpen+="",a.gameDetail.status+="",a.gameDetail.langData=a.gameDetail.gameLangMaps[0],a.image=a.gameDetail.langData.img,a.gameDetail.langData.img=a.gameDetail.langData.fullImg,a.pageLanguage=a.gameDetail.langData.langCode,1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.gameDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)),a.$apply()})}})},a.updateGame=function(){var b=apiDomain+updateGameApi,c=copyData(a.form.userInfo);c.gameId=a.form.gameId,c.webUrl=a.gameDetail.webUrl,c.status=a.gameDetail.status,c.inappOpen=a.gameDetail.inappOpen,c.startTime=a.gameDetail.startTime,c.endTime=a.gameDetail.endTime,c.langData=[{id:a.gameDetail.langData.id,name:a.gameDetail.langData.name,img:a.image,langCode:a.gameDetail.langData.langCode}],c.langData=angular.toJson(c.langData),$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),a.getGameDetail()})}})},a.merchantListEvent=function(){var b=apiDomain+getMerchantListApi,c=copyData(a.form.userInfo);c.startRow=0,c.maxRows=1e6,c.sortType="ASC",c.sortField="id",$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.merchantList=b.resultList,a.$apply()})}})},a.getMerchantDetail=function(b){var c=apiDomain+getMerchantDetailApi,d=copyData(a.form.userInfo);d.merchantId=b,$.ajax({type:a.form.postType,url:c,context:document.body,data:d,success:function(b){apiResultsProcessingFun(b,function(){for(var c=0;c<a.form.languageList.length;c++)a.form.languageList[c].select=!1;a.merchantDetail=b.result;for(var c=0;c<a.merchantDetail.merchantLangMapList.length;c++)a.merchantDetail.merchantLangMapList[c].isDefault&&(a.gameDetail.langData.langCode=a.merchantDetail.merchantLangMapList[c].langCode);a.$apply()})}})},a.selectPageLang=function(){d(function(){for(var b=0;b<a.gameDetail.gameLangMaps.length;b++)a.gameDetail.gameLangMaps[b].langCode==a.pageLanguage&&(a.gameDetail.langData=a.gameDetail.gameLangMaps[b],a.image=a.gameDetail.langData.img,a.gameDetail.langData.img=a.gameDetail.langData.fullImg)})},a.uploadFinish=function(b,c){a.gameDetail.langData.img=c.fullName,a.image=c.fileName,a.$apply()},a.form.gameId?(a.newGame=!1,a.getGameDetail()):(a.newGame=!0,a.gameDetail={langData:{},inappOpen:"1"},1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.gameDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)))}var GameDetailCtrl=["$scope","$translate","$state","$timeout","form","$location","$modal",gameDetailCtrl];angular.module("keeperp").controller("GameDetailCtrl",GameDetailCtrl);