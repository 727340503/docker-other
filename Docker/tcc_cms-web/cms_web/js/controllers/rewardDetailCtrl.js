function rewardDetailCtrl(a,b,c,d,e,f,g){if(a.form=e,a.cancel=function(){f.path("/main/rewardList")},a.form.giftId)var h={};else var h={logo:{required:!0}};$("#baseInfo").validate({errorPlacement:function(a,b){b.parent().after(a)},rules:h,messages:{},submitHandler:function(b){a.form.giftId?a.updateReward():a.addRewardRule()}}),a.addRewardRule=function(){var b=apiDomain+createGiftApi,c=copyData(a.form.userInfo);c.merchantId=a.rewardDetail.merchantId,a.rewardDetail.langData.image=a.image,c.langData=[],c.langData.push(a.rewardDetail.langData),c.langData=angular.toJson(c.langData),$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),d(function(){f.path("/main/rewardList")})})}})},a.getRewardRuleDetail=function(){var b=apiDomain+getGiftDetailApi,c=copyData(a.form.userInfo);c.giftId=a.form.giftId,$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.rewardDetail=b.result,a.rewardDetail.merchantId+="",a.rewardDetail.langData=a.rewardDetail.giftLangMaps[0],a.image=a.rewardDetail.langData.image,a.rewardDetail.langData.image=a.rewardDetail.langData.fullImage,a.pageLanguage=a.rewardDetail.langData.langCode,1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.rewardDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)),a.$apply()})}})},a.updateReward=function(){var b=apiDomain+updateGiftApi,c=copyData(a.form.userInfo);c.giftId=a.form.giftId,c.langData=[{id:a.rewardDetail.langData.id,image:a.image,descr:a.rewardDetail.langData.descr,langCode:a.rewardDetail.langData.langCode,name:a.rewardDetail.langData.name}],c.langData=angular.toJson(c.langData),$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.alert("success"," ","Success！"),a.getRewardRuleDetail()})}})},a.merchantListEvent=function(){var b=apiDomain+getMerchantListApi,c=copyData(a.form.userInfo);c.startRow=0,c.maxRows=1e6,c.sortType="ASC",c.sortField="id",$.ajax({type:a.form.postType,url:b,context:document.body,data:c,success:function(b){apiResultsProcessingFun(b,function(){a.merchantList=b.resultList,a.$apply()})}})},a.getMerchantDetail=function(b){var c=apiDomain+getMerchantDetailApi,d=copyData(a.form.userInfo);d.merchantId=b,$.ajax({type:a.form.postType,url:c,context:document.body,data:d,success:function(b){apiResultsProcessingFun(b,function(){for(var c=0;c<a.form.languageList.length;c++)a.form.languageList[c].select=!1;a.merchantDetail=b.result;for(var c=0;c<a.merchantDetail.merchantLangMapList.length;c++)a.merchantDetail.merchantLangMapList[c].isDefault&&(a.rewardDetail.langData.langCode=a.merchantDetail.merchantLangMapList[c].langCode);a.$apply()})}})},a.selectPageLang=function(){d(function(){for(var b=0;b<a.rewardDetail.giftLangMaps.length;b++)a.rewardDetail.giftLangMaps[b].langCode==a.pageLanguage&&(a.rewardDetail.langData=a.rewardDetail.giftLangMaps[b],a.image=a.rewardDetail.langData.image,a.rewardDetail.langData.image=a.rewardDetail.langData.fullImage)})},a.uploadFinish=function(b,c){a.rewardDetail.langData.image=c.fullName,a.image=c.fileName,a.$apply()},a.form.giftId?(a.newReward=!1,a.getRewardRuleDetail()):(a.newReward=!0,a.rewardDetail={langData:{}},1==a.form.systemUserRole.roleType?a.merchantListEvent():(a.rewardDetail.merchantId=a.form.merchantId,a.getMerchantDetail(a.form.merchantId)))}var RewardDetailCtrl=["$scope","$translate","$state","$timeout","form","$location","$modal",rewardDetailCtrl];angular.module("keeperp").controller("RewardDetailCtrl",RewardDetailCtrl);